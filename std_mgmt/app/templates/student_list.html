{% extends 'base.html' %}
{% block content %}
<h2>Students</h2>

<!-- Search Form -->
<form method="GET" class="mb-3 d-flex">
  <input 
    type="text" 
    name="q" 
    value="{{ request.GET.q }}" 
    class="form-control me-2" 
    placeholder="Search by name, roll number, email, or department..."
  >
  <button type="submit" class="btn btn-primary">Search</button>
</form>

<!-- Student Table -->
<table class="table table-bordered">
  <thead>
    <tr>
      <th>Name</th>
      <th>Roll No</th>
      <th>Email</th>
      <th>Department</th>
      <th>Year</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody>
    {% for student in students %}
    <tr>
      <td>{{ student.name }}</td>
      <td>{{ student.roll_number }}</td>
      <td>{{ student.email }}</td>
      <td>{{ student.department }}</td>
      <td>{{ student.year_of_admission }}</td>
      <td>
        <a href="{% url 'student_detail' student.id %}" class="btn btn-info btn-sm">View</a>
        <a href="{% url 'student_edit' student.id %}" class="btn btn-warning btn-sm">Edit</a>
        <a href="{% url 'student_delete' student.id %}" class="btn btn-danger btn-sm">Delete</a>
      </td>
    </tr>
    {% empty %}
    <tr>
      <td colspan="6" class="text-center">No students found.</td>
    </tr>
    {% endfor %}
  </tbody>
</table>

<!-- Pagination -->
<div class="d-flex justify-content-center">
  <nav>
    <ul class="pagination">
      {% if page_obj.has_previous %}
        <li class="page-item">
          <a class="page-link" href="?page={{ page_obj.previous_page_number }}{% if request.GET.q %}&q={{ request.GET.q }}{% endif %}">Previous</a>
        </li>
      {% endif %}

      {% for num in page_obj.paginator.page_range %}
        <li class="page-item {% if page_obj.number == num %}active{% endif %}">
          <a class="page-link" href="?page={{ num }}{% if request.GET.q %}&q={{ request.GET.q }}{% endif %}">{{ num }}</a>
        </li>
      {% endfor %}

      {% if page_obj.has_next %}
        <li class="page-item">
          <a class="page-link" href="?page={{ page_obj.next_page_number }}{% if request.GET.q %}&q={{ request.GET.q }}{% endif %}">Next</a>
        </li>
      {% endif %}
    </ul>
  </nav>
</div>

{% endblock %}
